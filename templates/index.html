<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Recommender</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            color: #ffffff;
            background: linear-gradient(115deg, #56d8e4 10%, #9f01ea 90%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        
        /* UPDATED: Animation is now defined for two effects */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .glass-container {
            width: 100%;
            max-width: 550px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 16px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            /* UPDATED: We removed the animation from the container itself */
        }
        
        /* UPDATED: Refined staggered animations for a smoother feel */
        h2, .form-group, button, .nav-link {
            animation: fadeInUp 0.5s ease-out forwards;
            opacity: 0; /* Start hidden */
        }
        h2 { animation-delay: 0.1s; }
        .form-group:nth-of-type(1) { animation-delay: 0.2s; }
        .form-group:nth-of-type(2) { animation-delay: 0.3s; }
        .form-group:nth-of-type(3) { animation-delay: 0.4s; }
        button { animation-delay: 0.5s; }
        .nav-link { animation-delay: 0.6s; }

        /* UPDATED: Results now have their own fade-in animation */
        .results-container, .error {
            animation: fadeIn 0.5s ease-out forwards;
        }

        h2 { text-align: center; margin-bottom: 20px; font-weight: 600; color: #ffffff; }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 500; color: #e0e0e0; }
        input, select {
            width: 100%; padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px; font-size: 16px; box-sizing: border-box;
            background-color: rgba(255, 255, 255, 0.1); 
            color: #ffffff;
        }
        input::placeholder { color: #cccccc; }
        select option { background: #333; }
        button { 
            padding: 15px; width: 100%; margin-top: 10px;
            background: linear-gradient(90deg, #89f7fe 0%, #66a6ff 100%);
            color: #111; border: none; border-radius: 8px; font-size: 18px;
            font-weight: 600; cursor: pointer; transition: transform 0.2s;
        }
        button:hover { transform: scale(1.02); }
        button:disabled { background: #555; cursor: not-allowed; }
        .error { text-align: center; font-size: 16px; margin-top: 25px; padding: 15px; border-radius: 8px; font-weight: 500; background-color: rgba(255, 0, 0, 0.2); color: #ffc0cb; border: 1px solid rgba(255, 0, 0, 0.3); }
        .results-container { margin-top: 30px; }
        .top-recommendation { background-color: rgba(0, 255, 127, 0.2); color: #98fb98; border: 1px solid rgba(0, 255, 127, 0.3); padding: 15px; border-radius: 8px; text-align: center; }
        .description-box { margin-top: 20px; padding: 15px; background-color: rgba(0, 0, 0, 0.2); border-left: 4px solid #87CEFA; border-radius: 4px; font-size: 0.95rem; line-height: 1.6; }
        .other-paths { margin-top: 15px; }
        .plot-container { margin-top: 20px; text-align: center; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; }
        .plot-container h4 { margin-bottom: 10px; }
        .plot-container img { max-width: 100%; border-radius: 8px; }
        .nav-link { text-align: center; margin-top: 20px; }
        .nav-link a { color: #87CEFA; text-decoration: none; font-weight: 500; }
    </style>
</head>
<body>
    <div class="glass-container">
        <form method="POST" id="recommendation-form">
            <h2>Career Recommender üöÄ</h2>
            
            <div class="form-group">
                <label for="gpa">GPA (Grade Point Average):</label>
                <input type="number" step="0.01" name="gpa" id="gpa" required placeholder="e.g. 8.5" min="0.0" max="10.0" value="{{ selected.gpa or '' }}">
            </div>
            <div class="form-group">
                <label for="interest">Primary Interest:</label>
                <select name="interest" id="interest" required>
                    <option value="" disabled selected>-- Select your interest --</option>
                    {% for interest in interests %}
                        <option value="{{ interest }}" {% if interest == selected.interest %}selected{% endif %}>{{ interest }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label for="skill">Top Skill:</label>
                <select name="skill" id="skill" required>
                    <option value="" disabled selected>-- Select your skill --</option>
                    {% for skill in skills %}
                        <option value="{{ skill }}" {% if skill == selected.skill %}selected{% endif %}>{{ skill }}</option>
                    {% endfor %}
                </select>
            </div>
            <button type="submit">Get Recommendation</button>
        </form>

        {% if error %}
            <div class="error">‚ö†Ô∏è {{ error }}</div>
        {% endif %}

        {% if predictions %}
            <div class="results-container">
                <div class="top-recommendation">
                    ‚úÖ Top Recommendation: <strong>{{ predictions[0][0] }}</strong><br>
                    <small>Confidence: {{ "%.2f"|format(predictions[0][1]*100) }}%</small>
                </div>
                {% if description %}
                    <div class="description-box">
                        <p>{{ description }}</p>
                    </div>
                {% endif %}
                {% if predictions|length > 1 %}
                    <div class="other-paths">
                        <h4>Other Potential Paths:</h4>
                        <ol>
                        {% for i in range(1, predictions|length) %}
                            <li>{{ predictions[i][0] }} (Confidence: {{ "%.2f"|format(predictions[i][1]*100) }}%)</li>
                        {% endfor %}
                        </ol>
                    </div>
                {% endif %}
                {% if plot_url %}
                    <div class="plot-container">
                        <h4>Why This Recommendation?</h4>
                        <img src="data:image/png;base64,{{ plot_url }}">
                    </div>
                {% endif %}
            </div>
        {% endif %}
        
        <div class="nav-link">
            <a href="/explorer">View Data Explorer üìä</a>
        </div>
    </div>

    <script>
        const form = document.getElementById('recommendation-form');
        form.addEventListener('submit', function() {
            const button = form.querySelector('button[type="submit"]');
            button.disabled = true;
            button.innerText = 'Analyzing...';
        });
    </script>
</body>
</html>